(function(){function d(){}d.prototype={bind:function(a){for(var b in a)c.addShortcut(b,a[b])},bindWithDelay:function(a){for(var b in a)c.addShortcut(b,this._handleDelayedShortcut(a[b]))},_handleDelayedShortcut:function(a){var b=null,e=null;return function(g){clearTimeout(b);clearTimeout(e);c.commandCanRun()&&null===b&&(b=setTimeout(function(){a(g)},150));e=setTimeout(function(){b=null},200)}}};var c={addShortcut:function(a,b){var c=new maxkir.KbdMatcher(a);maxkir.KbdMatcher.matchers.pop();c.resetUnmatched= function(a){c.has_sequence(a)||c.reset()};return maxkir.kbd.forCondition(function(a){return c.matches(a)}).addHook(function(a){b(a)})},collapse:function(){return maxkir.ChecklistNodeToggle.collapse(this.getTaskId())},expand:function(){return maxkir.ChecklistNodeToggle.expand(this.getTaskId())},setFocus:function(){return maxkir.TaskFocus.set_focus(this.getTaskId())},removeFocus:function(){return maxkir.TaskFocus.remove_focus(this.getTaskId())},commandCanRun:function(){return maxkir.cmd.can_run(!0)}, getTaskId:function(){return maxkir.Task.selected_task_id()}},f=new d;f.bindWithDelay({h:function(){c.collapse()},l:function(){c.expand()},o:function(a){maxkir.cmd.add_task()&&Event.stop(a)},"shift+g":function(){maxkir.tree_nav.selectLastInTree()}});f.bind({"shift+h":function(){c.removeFocus()},"shift+l":function(){c.setFocus()},"shift+o":function(a){maxkir.cmd.add_task(!0)&&Event.stop(a)},"alt+g alt+g":function(){maxkir.tree_nav.selectFirstInTree()}})})();
